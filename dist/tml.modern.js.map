{"version":3,"file":"tml.modern.js","sources":["../src/loader.ts","../src/tml.ts"],"sourcesContent":["// @ts-ignore\r\nexport const go = new global.Go();\r\n\r\nif (!WebAssembly.instantiateStreaming) {\r\n  WebAssembly.instantiateStreaming = async (resp, importObject) => {\r\n    const source = await(await resp).arrayBuffer();\r\n    return await WebAssembly.instantiate(source, importObject);\r\n  };\r\n}\r\n\r\nexport const load: (path: string) => Promise<void> = async (path) => {\r\n  try {\r\n    const {instance} = await WebAssembly.instantiateStreaming(fetch(path), go.importObject);\r\n\r\n    await go.run(instance);\r\n  } catch (e) {\r\n    throw e;\r\n  }\r\n};","import {load} from \"./loader\";\r\nimport {ParserConfig, Workout} from \"./types\";\r\n\r\nconst notReadyYet = new Error(\"WASM module is not ready yet\");\r\n\r\nexport let onReady: () => void = () => {};\r\nif (!(\"TML\" in global))  {\r\n  load(\"https://cdn.jsdelivr.net/gh/yanishoss/tml/bin/main.wasm\")\r\n    .then(() => onReady())\r\n    .catch(e => {throw e});\r\n}\r\n\r\nexport function parse(input: string, conf?: ParserConfig): Workout {\r\n  if (!(\"TML\" in global))  {\r\n    throw notReadyYet;\r\n  }\r\n\r\n  // @ts-ignore\r\n  const ret = TML.parse(input, conf);\r\n\r\n  if (ret.Error !== undefined) {\r\n    throw new Error(ret.Error());\r\n  }\r\n\r\n  return ret;\r\n}\r\n\r\nexport function withDefaultConfig(): ParserConfig {\r\n  if (!(\"TML\" in global))  {\r\n    throw notReadyYet;\r\n  }\r\n\r\n  // @ts-ignore\r\n  return TML.withDefaultConfig(input, conf);\r\n}"],"names":["go","global","Go","WebAssembly","instantiateStreaming","async","resp","importObject","source","arrayBuffer","instantiate","notReadyYet","Error","onReady","parse","input","conf","ret","TML","undefined","withDefaultConfig","instance","fetch","run","e","load","then","catch"],"mappings":"MACaA,EAAK,IAAIC,OAAOC,GAExBC,YAAYC,uBACfD,YAAYC,qBAAuBC,MAAOC,EAAMC,KAC9C,MAAMC,cAAqBF,GAAMG,cACjC,aAAaN,YAAYO,YAAYF,EAAQD,WCH3CI,EAAc,IAAIC,MAAM,gCAEnBC,IAAAA,EAAsB,OAOjC,SAAgBC,EAAMC,EAAeC,GACnC,KAAM,QAASf,QACb,MAAMU,EAIR,MAAMM,EAAMC,IAAIJ,MAAMC,EAAOC,GAE7B,QAAkBG,IAAdF,EAAIL,MACN,UAAUA,MAAMK,EAAIL,SAGtB,OAAOK,EAGT,SAAgBG,IACd,KAAM,QAASnB,QACb,MAAMU,EAIR,OAAOO,IAAIE,kBAAkBL,MAAOC,MA3BhC,QAASf,QDIsCI,OAAAA,IACnD,IACE,MAAMgB,SAACA,SAAkBlB,YAAYC,qBAAqBkB,MCLvD,2DDKoEtB,EAAGO,oBAEpEP,EAAGuB,IAAIF,GACb,MAAOG,GACP,MAAMA,ICTRC,GACGC,KAAK,QACLC,MAAMH,IAAM,MAAMA"}